{"file":"wallet-transactions.entry.esm.js","mappings":"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","names":[],"sources":["src/components/wallet-transactions/wallet-transactions.css?tag=wallet-transactions&encapsulation=shadow","src/components/wallet-transactions/wallet-transactions.tsx"],"sourcesContent":[":host {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  min-height: 100vh;\r\n  background: #f7f9fb;\r\n  font-family: 'Inter', 'Segoe UI', Arial, sans-serif;\r\n}\r\n\r\n.transactions-container {\r\n  background: #fff;\r\n  border-radius: 18px;\r\n  box-shadow: 0 2px 16px rgba(0,0,0,0.07);\r\n  padding: 2rem 2rem 1.5rem 2rem;\r\n  margin: 1.5rem auto 0 auto;\r\n  width: 100%;\r\n  max-width: 900px;\r\n  min-width: 0;\r\n  box-sizing: border-box;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: flex-start;\r\n}\r\n\r\n.top-bar {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  width: 100%;\r\n  margin-bottom: 1.5rem;\r\n  background: none;\r\n  border-radius: 0;\r\n  box-shadow: none;\r\n  padding: 0;\r\n}\r\n.left-section {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 2rem;\r\n}\r\n.top-bar .back-btn {\r\n  background: #f7f9fb;\r\n  color: #2563eb;\r\n  border: 1.5px solid #2563eb;\r\n  font-weight: 600;\r\n  border-radius: 8px;\r\n  padding: 0.45rem 1.1rem;\r\n  font-size: 1rem;\r\n  transition: background 0.2s, color 0.2s;\r\n  box-shadow: 0 1px 4px rgba(0,0,0,0.03);\r\n  margin-right: 0;\r\n}\r\n.top-bar .back-btn:hover {\r\n  background: #2563eb;\r\n  color: #fff;\r\n}\r\n.top-bar h2 {\r\n  margin: 0;\r\n  font-size: 2.2rem;\r\n  font-weight: 700;\r\n  color: #111827;\r\n  flex: 1;\r\n  text-align: center;\r\n}\r\n\r\n.export-btn {\r\n  background: #2563eb;\r\n  color: white;\r\n  border: none;\r\n  font-weight: 600;\r\n  border-radius: 8px;\r\n  padding: 0.45rem 1.1rem;\r\n  font-size: 1rem;\r\n  transition: background 0.2s;\r\n  box-shadow: 0 1px 4px rgba(0,0,0,0.03);\r\n  cursor: pointer;\r\n  margin-left: 0;\r\n}\r\n.export-btn:hover {\r\n  background: #1d4ed8;\r\n}\r\n\r\n.transactions-table {\r\n  width: 100%;\r\n  border-collapse: separate;\r\n  border-spacing: 0;\r\n  background: #f8fafc;\r\n  border-radius: 12px;\r\n  box-shadow: 0 2px 12px rgba(0,0,0,0.04);\r\n  overflow-x: auto;\r\n  margin-bottom: 1.2rem;\r\n  display: block;\r\n}\r\n.transactions-table thead, .transactions-table tbody {\r\n  display: table;\r\n  width: 100%;\r\n  table-layout: fixed;\r\n}\r\n.transactions-table th, .transactions-table td {\r\n  padding: 0.5rem 0.7rem;\r\n  text-align: left;\r\n  white-space: normal;\r\n  word-break: break-word;\r\n  overflow-wrap: break-word;\r\n}\r\n.transactions-table th {\r\n  background: #f1f5f9;\r\n  color: #334155;\r\n  font-weight: 600;\r\n  font-size: 1rem;\r\n  border-bottom: 1px solid #e2e8f0;\r\n  cursor: pointer;\r\n}\r\n.transactions-table td {\r\n  color: #22223b;\r\n  font-size: 0.98rem;\r\n  border-bottom: 1px solid #f1f5f9;\r\n}\r\n.transactions-table tr:last-child td {\r\n  border-bottom: none;\r\n}\r\n.transactions-table tr:nth-child(even) td {\r\n  background: #fff;\r\n}\r\n\r\n.pagination {\r\n  display: flex;\r\n  gap: 1.2rem;\r\n  margin-bottom: 0.5rem;\r\n}\r\n.pagination button {\r\n  background: #e5edfa;\r\n  color: #22223b;\r\n  border: none;\r\n  border-radius: 8px;\r\n  font-weight: 600;\r\n  font-size: 1.1rem;\r\n  padding: 0.7rem 1.5rem;\r\n  transition: background 0.2s;\r\n}\r\n.pagination button:disabled {\r\n  background: #f1f5f9;\r\n  color: #b0b7c3;\r\n  cursor: not-allowed;\r\n}\r\n.pagination button:hover:not(:disabled) {\r\n  background: #c7d7f7;\r\n}\r\n\r\n.error {\r\n  color: #e11d48;\r\n  background: #fef2f2;\r\n  border-radius: 8px;\r\n  padding: 1rem;\r\n  margin-top: 2rem;\r\n  font-size: 1.05rem;\r\n  border: 1px solid #fecaca;\r\n}\r\n\r\n@media (max-width: 900px) {\r\n  .transactions-container {\r\n    max-width: 98vw;\r\n    padding: 1.2rem 0.5rem 1rem 0.5rem;\r\n  }\r\n  .top-bar h2 {\r\n    font-size: 1.3rem;\r\n  }\r\n}\r\n@media (max-width: 700px) {\r\n  .transactions-container {\r\n    max-width: 98vw;\r\n    min-width: 0;\r\n    padding: 1rem 0.3rem 0.7rem 0.3rem;\r\n  }\r\n  .transactions-table {\r\n    font-size: 0.95rem;\r\n    display: block;\r\n    overflow-x: auto;\r\n  }\r\n  .transactions-table th, .transactions-table td {\r\n    padding: 0.4rem 0.3rem;\r\n    font-size: 0.95rem;\r\n    white-space: normal;\r\n    word-break: break-word;\r\n    overflow-wrap: break-word;\r\n  }\r\n}\r\n@media (max-width: 600px) {\r\n  .transactions-container {\r\n    padding: 0.7rem 0.2rem 0.7rem 0.2rem;\r\n    min-width: 0;\r\n  }\r\n  .top-bar {\r\n    flex-direction: column;\r\n    align-items: stretch;\r\n    gap: 0.7rem;\r\n  }\r\n  .top-bar h2 {\r\n    font-size: 1.1rem;\r\n    text-align: left;\r\n  }\r\n  .export-btn, .back-btn {\r\n    width: 100%;\r\n    font-size: 0.95rem;\r\n    padding: 0.7rem 0.7rem;\r\n  }\r\n}\r\n@media (max-width: 500px) {\r\n  .transactions-container {\r\n    padding: 0.7rem 0.1rem 0.7rem 0.1rem;\r\n  }\r\n  .transactions-table th, .transactions-table td {\r\n    font-size: 0.92rem;\r\n    padding: 0.3rem 0.2rem;\r\n  }\r\n}\r\n","import { Component, Event, EventEmitter, h, Prop } from '@stencil/core';\r\nimport { API_BASE_URL } from '../../config';\r\n\r\n@Component({\r\n  tag: 'wallet-transactions',\r\n  styleUrl: 'wallet-transactions.css',\r\n  shadow: true,\r\n})\r\nexport class WalletTransactions {\r\n  @Prop() walletId: string;\r\n  @Event() back: EventEmitter<void>;\r\n  @Event() notificationChange: EventEmitter<{ message: string; type: 'success' | 'error' }>;\r\n\r\n  async handleExportCSV() {\r\n    try {\r\n      const transactionRes = await fetch(`${API_BASE_URL}/transactions?walletId=${this.walletId}&skip=0&limit=10000`);\r\n      if (!transactionRes.ok) {\r\n        throw new Error(`Failed to fetch transactions: ${transactionRes.statusText}`);\r\n      }\r\n      const data = await transactionRes.json();\r\n\r\n      let username = 'wallet';\r\n      try {\r\n        const walletRes = await fetch(`${API_BASE_URL}/wallet/${this.walletId}`);\r\n        if (!walletRes.ok) {\r\n          throw new Error(`Failed to fetch wallet: ${walletRes.statusText}`);\r\n        }\r\n        const wallet = await walletRes.json();\r\n        username = wallet.name || 'wallet';\r\n      } catch (walletErr) {\r\n        console.warn('Failed to fetch wallet name, using default:', walletErr);\r\n      }\r\n\r\n      const headers = ['Date', 'Amount', 'Description', 'Type', 'Balance'];\r\n      const rows = data.map((transaction: any) => [\r\n        transaction.date\r\n          ? new Date(transaction.date).toLocaleString()\r\n          : (transaction.transaction_time_stamp\r\n              ? new Date(transaction.transaction_time_stamp).toLocaleString()\r\n              : ''),\r\n        transaction.amount?.toFixed(4) ?? '',\r\n        transaction.description || '',\r\n        transaction.type ? (transaction.type.charAt(0).toUpperCase() + transaction.type.slice(1).toLowerCase()) : '',\r\n        transaction.balance?.toFixed(4) ?? ''\r\n      ]);\r\n\r\n      let csvContent = headers.join(',') + '\\n';\r\n      csvContent += rows.map(r => r.map(field => \r\n        '\"' + (field != null ? String(field).replace(/\"/g, '\"\"').replace(/\\n/g, ' ') : '').trim() + '\"'\r\n      ).join(',')).join('\\n');\r\n\r\n      const now = new Date();\r\n      const dateStr = `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}-${String(now.getDate()).padStart(2,'0')}`;\r\n      const safeUsername = username.replace(/[^a-zA-Z0-9_-]/g, '');\r\n      const filename = `${safeUsername}_transactions_${dateStr}.csv`;\r\n\r\n      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n      const url = URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = filename;\r\n      a.click();\r\n      URL.revokeObjectURL(url);\r\n\r\n      this.notificationChange.emit({ message: 'Transactions exported successfully', type: 'success' });\r\n    } catch (err) {\r\n      console.error('Export failed:', err);\r\n      this.notificationChange.emit({ \r\n        message: err instanceof Error ? err.message : 'Failed to export transactions', \r\n        type: 'error' \r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div class=\"transactions-container\">\r\n        <div class=\"top-bar\">\r\n          <button class=\"back-btn\" onClick={() => this.back.emit()}>&larr; Back</button>\r\n          <h2>Transactions</h2>\r\n          <button class=\"export-btn\" onClick={() => this.handleExportCSV()}>Export CSV</button>\r\n        </div>\r\n        <wallet-transactions-table wallet-id={this.walletId} />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"],"version":3}