import{r as t,h as e,a,c as r}from"./p-Diglr-ky.js";const i=":host{position:fixed;left:50%;top:2.5rem;z-index:9999;display:flex;justify-content:center;width:100vw;pointer-events:none;transform:translateX(-50%)}.toast{min-width:220px;max-width:90vw;background:#fff;color:#2563eb;border-radius:12px;box-shadow:0 2px 16px rgba(37,99,235,0.13);padding:1rem 2rem;font-size:1.08rem;font-weight:500;opacity:0;transform:translateY(-40px) scale(0.98);transition:opacity 0.3s, transform 0.3s;pointer-events:auto;border:1.5px solid #2563eb;text-align:center}.toast.success{background:#e0f2fe;color:#2563eb;border-color:#2563eb}.toast.error{background:#fef2f2;color:#e11d48;border-color:#e11d48}.toast.show{opacity:1;transform:translateY(0) scale(1)}@media (max-width: 600px){.toast{padding:0.7rem 1rem;font-size:0.98rem}}";const o=class{constructor(e){t(this,e)}message="";type="success";duration=3e3;visible=false;hideTimeout;disconnectedCallback(){if(this.hideTimeout){clearTimeout(this.hideTimeout)}}onMessageChange(){if(this.hideTimeout){clearTimeout(this.hideTimeout)}this.visible=Boolean(this.message);if(this.message){this.hideTimeout=window.setTimeout((()=>{this.visible=false}),this.duration)}}render(){return e("div",{key:"ef3069653ee318120a2cfb96df0f81318fa5d85a",class:{toast:true,show:this.visible&&Boolean(this.message),success:this.type==="success",error:this.type==="error"}},this.message)}static get watchers(){return{message:["onMessageChange"]}}};o.style=i;const n="https://wallet-app-wlvr.onrender.com/";const s=':host{display:block;min-height:100vh;background:#f7f9fb;font-family:\'Inter\', \'Segoe UI\', Arial, sans-serif;box-sizing:border-box;width:100%;max-width:100vw;overflow-x:hidden}html,body{overflow-x:hidden !important;overflow-y:auto !important;width:100%;max-width:100vw;height:100vh;margin:0;padding:0;position:fixed;box-sizing:border-box}header{position:relative;left:0;right:0;width:100vw;max-width:100vw;min-width:0;overflow-x:hidden;background:#2563eb;color:#fff;padding:1.5rem 0;text-align:center;margin-bottom:2rem;box-shadow:0 2px 8px rgba(0,0,0,0.04);z-index:100}header h1{font-size:2.1rem;font-weight:700;letter-spacing:0.01em;margin:0;width:100%;box-sizing:border-box;overflow-wrap:break-word;white-space:normal}main{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:80%;width:100vw;box-sizing:border-box;margin:0;padding:0 1rem}@media (max-width: 900px){header h1{font-size:1.5rem}main{padding:0 0.5rem}}@media (max-width: 600px){header{padding:1rem 0.2rem;font-size:1.3rem}header h1{font-size:1.1rem}main{padding:0 0.2rem}}:host,.theme-light{--bg:#f7f9fb;--text:#111827;--header-bg:#2563eb;--header-text:#fff;--card-bg:#fff;--card-shadow:0 2px 16px rgba(37,99,235,0.08);--input-bg:#fff;--input-border:#cbd5e1;--input-focus:#2563eb;--primary:#2563eb;--primary-hover:#1d4ed8;--danger:#e11d48;--card-radius:18px}.theme-dark{--bg:#181a1b;--text:#f3f4f6;--header-bg:#2563eb;--header-text:#e0e7ef;--card-bg:#23272f;--card-shadow:0 2px 16px rgba(0,0,0,0.25);--input-bg:#23272f;--input-border:#374151;--input-focus:#2563eb;--primary:#2563eb;--primary-hover:#1d4ed8;--danger:#e11d48;--card-radius:18px}:host,body,html{background:var(--bg) !important;color:var(--text)}header{background:var(--header-bg);color:var(--header-text)}.wallet-card,.card,.transactions-container{background:var(--card-bg);box-shadow:var(--card-shadow);color:var(--text)}input[type="number"],input[type="text"]{background:var(--input-bg);border:1.5px solid var(--input-border);color:var(--text)}input[type="number"]:focus,input[type="text"]:focus{border-color:var(--input-focus);box-shadow:0 0 0 3px rgba(37,99,235,0.12)}.submit-btn{background:var(--primary);color:#fff}.submit-btn:hover{background:var(--primary-hover)}.view-transactions-btn{border:1.5px solid var(--primary);color:var(--primary)}.view-transactions-btn:hover{background:#eff6ff}.error{color:var(--danger)}';const d=class{constructor(e){t(this,e)}get el(){return a(this)}page="setup";walletId="";theme="light";notification={message:"",type:"success"};config={apiBaseUrl:n,notificationDuration:3e3};notificationTimeout;mediaQuery;componentWillLoad(){this.setupThemeDetection();return this.loadSavedWallet()}disconnectedCallback(){if(this.notificationTimeout){window.clearTimeout(this.notificationTimeout)}if(this.mediaQuery?.removeEventListener){this.mediaQuery.removeEventListener("change",this.handleThemeChange)}}setupThemeDetection(){try{this.mediaQuery=window.matchMedia("(prefers-color-scheme: dark)");this.theme=this.mediaQuery.matches?"dark":"light";if(this.mediaQuery.addEventListener){this.mediaQuery.addEventListener("change",this.handleThemeChange)}}catch(t){console.error("Failed to setup theme detection:",t);this.theme="light"}}handleThemeChange(t){this.theme=t.matches?"dark":"light"}async loadSavedWallet(){const t=localStorage.getItem("walletId");if(!t){return}try{const e=await fetch(`${this.config.apiBaseUrl}/wallet/${t}`);if(!e.ok){const t=await e.text();throw new Error(t||"Failed to load wallet")}this.walletId=t;this.page="dashboard"}catch(t){console.error("Failed to load wallet:",t);this.showNotification(t.message==="Failed to fetch"?"Unable to connect to backend.":"Wallet does not exist in the system. Please create a new wallet.","error");localStorage.removeItem("walletId");this.walletId="";this.page="setup"}}showNotification=(t,e="success")=>{if(this.notificationTimeout){window.clearTimeout(this.notificationTimeout)}this.notification={message:t,type:e};this.notificationTimeout=window.setTimeout((()=>{this.notification={message:"",type:"success"}}),this.config.notificationDuration)};handleWalletCreated=async t=>{if(t.detail.walletId){this.walletId=t.detail.walletId;localStorage.setItem("walletId",t.detail.walletId);try{const e=await fetch(`${this.config.apiBaseUrl}/wallet/${t.detail.walletId}`);if(!e.ok){throw new Error("Failed to verify wallet")}await e.json();this.page="dashboard"}catch(t){console.error("Error verifying wallet:",t);this.showNotification("Error loading wallet details","error");localStorage.removeItem("walletId");this.walletId="";this.page="setup"}}};handleShowTransactions=()=>{if(this.walletId){this.page="transactions"}};handleBack=()=>{this.page="dashboard"};handleNotificationChange=t=>{if(t.detail.message){this.showNotification(t.detail.message,t.detail.type)}};render(){const t={"api-base-url":this.config.apiBaseUrl,onNotificationChange:this.handleNotificationChange};return e("div",{key:"a9c81d61cb67090bc4691f50fc21e456e4809d33",class:`theme-${this.theme}`},e("header",{key:"10c413430dcc863a1af6691b8bbfc70daec1c892"},e("h1",{key:"45aec37785d5f52c5cd624bbd66e35ca8169aa19"},"Wallet App")),e("main",{key:"28da01ce7b7bfca2593fd3f8ef71e8cffe4f3ca2"},this.page==="setup"&&e("wallet-setup",{key:"216838a7991448b45d64f23f03fe840c8b95b695",...t,onWalletCreated:this.handleWalletCreated}),this.page==="dashboard"&&this.walletId&&e("wallet-dashboard",{key:"d4f5fe5b790810980dbdbab69f20b4cd520c9f16",...t,"wallet-id":this.walletId,onShowTransactions:this.handleShowTransactions}),this.page==="transactions"&&this.walletId&&e("wallet-transactions",{key:"a423a1501f92be89f35ae61fc72f01031e607a98",...t,"wallet-id":this.walletId,onBack:this.handleBack})),e("notification-toast",{key:"cc1ec8ba9357b7d8a6b5b37747da2381f73eeacb",message:this.notification.message,type:this.notification.type}))}};d.style=s;const c=':host{display:flex;flex-direction:column;align-items:center;min-height:100vh;background:#f7f9fb;font-family:\'Inter\', \'Segoe UI\', Arial, sans-serif}.wallet-card{background:#fff;border-radius:18px;box-shadow:0 2px 16px rgba(37,99,235,0.08);padding:2.5rem 2rem;width:100%;max-width:400px;min-width:0;box-sizing:border-box;display:flex;flex-direction:column;align-items:center}@media (max-width: 900px){.wallet-card{max-width:90vw;padding:2rem 1rem}}@media (max-width: 600px){.wallet-card{padding:1.2rem 0.5rem;max-width:100vw;min-width:0;border-radius:12px}h2{font-size:1.3rem}.balance-box{padding:0.8rem 0.5rem;font-size:1rem}form{gap:0.7rem}input[type="number"],input[type="text"],.submit-btn,.view-transactions-btn{font-size:0.95rem;padding:0.7rem 0.7rem}}@media (max-width: 400px){.wallet-card{padding:0.7rem 0.2rem 0.7rem 0.2rem}.balance-box{padding:0.5rem 0.2rem;font-size:0.95rem}}.card{background:#fff;border-radius:1.25rem;box-shadow:0 2px 16px 0 rgba(37,99,235,0.08);padding:2rem 1.5rem;margin:0 auto;max-width:400px;width:100%;min-width:360px;box-sizing:border-box}@media (max-width: 500px){.card{padding:1.5rem 0.5rem;max-width:100vw;min-width:0}}h2{font-size:2rem;font-weight:700;margin:0 0 1.5rem 0;color:#000000;text-align:center}h2 span{color:#2563eb}.balance-box{background:#f0f9ff;color:#0369a1;padding:1rem 2rem;border-radius:12px;font-size:1.1rem;font-weight:500;margin-bottom:2rem;width:100%;text-align:center;box-sizing:border-box}form{width:100%;display:flex;flex-direction:column;gap:1.1rem;margin-bottom:1.2rem}input[type="number"],input[type="text"],.submit-btn,.view-transactions-btn{width:100%;box-sizing:border-box}input[type="number"],input[type="text"]{padding:0.8rem 1rem;border:1.5px solid #cbd5e1;border-radius:8px;font-size:1rem;background:#fff;width:100%;box-sizing:border-box}input[type="number"]:focus,input[type="text"]:focus{outline:none;border-color:#2563eb;box-shadow:0 0 0 3px rgba(37,99,235,0.12)}.toggle-row{display:flex;align-items:center;gap:1rem;margin:0.5rem 0}.toggle-info{color:#64748b;font-size:0.95rem}.toggle-switch{position:relative;display:inline-block;width:50px;height:26px}.toggle-switch input{opacity:0;width:0;height:0}.toggle-slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#e11d48;transition:.3s;border-radius:26px}.toggle-slider:before{position:absolute;content:"";height:18px;width:18px;left:4px;bottom:4px;background-color:white;transition:.3s;border-radius:50%}input:checked+.toggle-slider{background-color:#2563eb}input:checked+.toggle-slider:before{transform:translateX(24px)}.toggle-label{font-size:0.9rem;font-weight:500}.toggle-label.credit{color:#2563eb}.toggle-label.debit{color:#e11d48}.submit-btn{background:#2563eb;color:white;border:none;padding:0.8rem;border-radius:8px;font-size:1rem;font-weight:500;cursor:pointer;width:100%;margin-top:0.5rem}.submit-btn:hover{background:#1d4ed8}.submit-btn:disabled{background:#94a3b8;cursor:not-allowed}.view-transactions-btn{background:none;border:1.5px solid #2563eb;color:#2563eb;padding:0.8rem;border-radius:8px;font-size:0.95rem;font-weight:500;cursor:pointer;width:100%;margin-top:1rem;transition:all 0.2s}.view-transactions-btn:hover{background:#eff6ff}.error{color:#e11d48;font-size:0.9rem;margin-top:1rem;text-align:center}.wallet-card.loading{align-items:center;justify-content:center;gap:1.5rem;min-height:200px}.wallet-card.error{align-items:center;justify-content:center;min-height:200px;color:#ef4444;text-align:center}.loading-spinner{width:40px;height:40px;border:3px solid #f3f3f3;border-top:3px solid #2563eb;border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}';const l=class{constructor(e){t(this,e);this.showTransactions=r(this,"showTransactions");this.notificationChange=r(this,"notificationChange")}walletId;showTransactions;notificationChange;wallet=null;amount="";description="";isCredit=true;loading=false;loadingWallet=false;async componentWillLoad(){if(this.walletId){return this.fetchWallet()}}async walletIdChanged(t,e){if(t&&t!==e){await this.fetchWallet()}}async fetchWallet(){if(!this.walletId)return;this.loadingWallet=true;try{const t=await fetch(`${n}/wallet/${this.walletId}`);if(!t.ok){throw new Error(await t.text()||"Network error")}const e=await t.json();this.wallet={id:e.id||e._id,balance:e.balance,name:e.name,date:e.date?new Date(e.date):undefined}}catch(t){console.error("Wallet fetch error:",t);this.notificationChange.emit({message:t instanceof Error?t.message:"Error loading wallet",type:"error"});this.wallet=null}finally{this.loadingWallet=false}}async handleTransaction(t){t.preventDefault();if(!this.amount){this.notificationChange.emit({message:"Amount is required",type:"error"});return}if(parseFloat(this.amount)<=0){this.notificationChange.emit({message:"Amount must be greater than 0",type:"error"});return}this.loading=true;try{const t=parseFloat(this.amount)*(this.isCredit?1:-1);const e=await fetch(`${n}/transact/${this.walletId}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:t,description:this.description})});const a=await e.json();if(!e.ok){this.notificationChange.emit({message:a.error||"Transaction failed",type:"error"});return}if(this.wallet){this.wallet.balance=a.balance}this.amount="";this.description="";this.notificationChange.emit({message:"Transaction successful!",type:"success"})}catch(t){this.notificationChange.emit({message:"Error processing transaction",type:"error"})}finally{this.loading=false}}render(){if(this.loadingWallet){return e("div",{class:"wallet-card loading"},e("div",{class:"loading-spinner"}),e("p",null,"Loading wallet details..."))}if(!this.wallet){return e("div",{class:"wallet-card error"},e("p",null,"Could not load wallet details. Please try again."))}return e("div",{class:"wallet-card"},e("h2",null,"Welcome, ",e("span",null,this.wallet.name)),e("div",{class:"balance-box"},"Balance: ",this.wallet.balance.toFixed(4)),e("form",{onSubmit:t=>this.handleTransaction(t)},e("input",{type:"number",step:"0.0001",min:"0.0001",pattern:"^\\\\d*\\\\.?\\\\d{0,4}$",onInput:t=>{const e=t.target.value;const a=e.split(".");if(a[1]&&a[1].length>4){t.target.value=`${a[0]}.${a[1].slice(0,4)}`}this.amount=t.target.value},value:this.amount,placeholder:"Amount",required:true}),e("input",{type:"text",value:this.description,onInput:t=>this.description=t.target.value,placeholder:"Description"}),e("div",{class:"toggle-row"},e("span",{class:"toggle-info"},"Select transaction type"),e("label",{class:"toggle-switch"},e("input",{type:"checkbox",checked:this.isCredit,onChange:()=>this.isCredit=!this.isCredit}),e("span",{class:"toggle-slider"})),e("span",{class:"toggle-label "+(this.isCredit?"credit":"debit")},this.isCredit?"Credit":"Debit")),e("button",{class:"submit-btn",type:"submit",disabled:this.loading},this.loading?"Processing...":"Submit")),e("button",{class:"view-transactions-btn",onClick:()=>this.showTransactions.emit()},"View Transactions"))}static get watchers(){return{walletId:["walletIdChanged"]}}};l.style=c;const b='.card{background:#fff;border-radius:1.25rem;box-shadow:0 2px 16px 0 rgba(37,99,235,0.08);padding:2rem 1.5rem;margin:0 auto;max-width:400px;width:100%;min-width:360px;box-sizing:border-box}@media (max-width: 500px){.card{padding:1.5rem 0.5rem;max-width:100vw;min-width:0}}h2{font-size:2rem;font-weight:700;margin-bottom:1.2rem;margin-top:0;letter-spacing:0.01em;color:#2563eb;text-align:center}form{width:100%;display:flex;flex-direction:column;gap:1.1rem;margin-bottom:1.2rem}input[type="number"],input[type="text"]{padding:0.6rem 0.8rem;border:1.5px solid #cbd5e1;border-radius:7px;font-size:1rem;background:#f8fafc;color:#22223b;margin-bottom:0.2rem}input[type="number"]::-webkit-inner-spin-button,input[type="number"]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.submit-btn{width:100%;padding:0.7rem 0;background:#2563eb;color:#fff;border:none;border-radius:7px;font-weight:600;font-size:1.1rem;margin-top:0.5rem;margin-bottom:0.7rem;transition:background 0.2s}.submit-btn:disabled{background:#cbd5e1;color:#64748b;cursor:not-allowed}.submit-btn:hover:not(:disabled){background:#1d4ed8}.error{color:#e11d48;background:#fef2f2;border-radius:8px;padding:0.7rem 1rem;margin-top:1rem;font-size:1.05rem;border:1px solid #fecaca}';const h=class{constructor(e){t(this,e);this.walletCreated=r(this,"walletCreated");this.notificationChange=r(this,"notificationChange")}walletCreated;notificationChange;name="";balance="";loading=false;error="";async handleSubmit(t){t.preventDefault();this.error="";if(!this.name||!this.balance){this.notificationChange.emit({message:"Name and balance are required",type:"error"});return}if(Number(this.balance)<0){this.notificationChange.emit({message:"Initial balance must be greater than 0",type:"error"});return}this.loading=true;try{const t=await fetch(`${n}/setup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:this.name,balance:Number(this.balance)})});if(!t.ok){const e=await t.json().catch((()=>({})));throw new Error(e.error||"Failed to create wallet")}const e=await t.json();this.notificationChange.emit({message:"Wallet created successfully!",type:"success"});this.name="";this.balance="";this.walletCreated.emit({walletId:e.id})}catch(t){const e=t instanceof Error?t.message:"Failed to create wallet";this.notificationChange.emit({message:e,type:"error"})}finally{this.loading=false}}handleBalanceInput=t=>{const e=t.target;const a=e.value;const r=a.split(".");if(r[1]&&r[1].length>4){e.value=`${r[0]}.${r[1].slice(0,4)}`}this.balance=e.value};render(){return e("div",{key:"88181e79ed180558d4df91d7ff1b3fec25b6f986",class:"card"},e("h2",{key:"912b87228fb1620129971a36f031c018064b2894"},"Setup Wallet"),e("form",{key:"60384c38091b61acdc1a37e942b3a9ca7fd64033",onSubmit:t=>this.handleSubmit(t)},e("input",{key:"24bf22ddc26fd92f29728b9e238ecd5c023171e7",type:"text",value:this.name,onInput:t=>this.name=t.target.value,placeholder:"Name",required:true}),e("input",{key:"4fb155755499bc1f7d4bfebfabe091aeb8ef195c",type:"number",step:"0.0001",min:"0.0001",pattern:"^\\\\d*\\\\.?\\\\d{0,4}$",onInput:this.handleBalanceInput,value:this.balance,placeholder:"Initial Balance",required:true}),e("button",{key:"0f36dbda93680ad100a390e05fe09b3ab93a2020",class:"submit-btn",type:"submit",disabled:this.loading},this.loading?"Creating...":"Create Wallet")))}};h.style=b;const f=":host{display:flex;flex-direction:column;align-items:center;min-height:100vh;background:#f7f9fb;font-family:'Inter', 'Segoe UI', Arial, sans-serif}.transactions-container{background:#fff;border-radius:18px;box-shadow:0 2px 16px rgba(0,0,0,0.07);padding:2rem 2rem 1.5rem 2rem;margin:1.5rem auto 0 auto;width:100%;max-width:900px;min-width:0;box-sizing:border-box;display:flex;flex-direction:column;align-items:flex-start}.top-bar{display:flex;align-items:center;justify-content:space-between;width:100%;margin-bottom:1.5rem;background:none;border-radius:0;box-shadow:none;padding:0}.left-section{display:flex;align-items:center;gap:2rem}.top-bar .back-btn{background:#f7f9fb;color:#2563eb;border:1.5px solid #2563eb;font-weight:600;border-radius:8px;padding:0.45rem 1.1rem;font-size:1rem;transition:background 0.2s, color 0.2s;box-shadow:0 1px 4px rgba(0,0,0,0.03);margin-right:0}.top-bar .back-btn:hover{background:#2563eb;color:#fff}.top-bar h2{margin:0;font-size:2.2rem;font-weight:700;color:#111827;flex:1;text-align:center}.export-btn{background:#2563eb;color:white;border:none;font-weight:600;border-radius:8px;padding:0.45rem 1.1rem;font-size:1rem;transition:background 0.2s;box-shadow:0 1px 4px rgba(0,0,0,0.03);cursor:pointer;margin-left:0}.export-btn:hover{background:#1d4ed8}.transactions-table{width:100%;border-collapse:separate;border-spacing:0;background:#f8fafc;border-radius:12px;box-shadow:0 2px 12px rgba(0,0,0,0.04);overflow-x:auto;margin-bottom:1.2rem;display:block}.transactions-table thead,.transactions-table tbody{display:table;width:100%;table-layout:fixed}.transactions-table th,.transactions-table td{padding:0.5rem 0.7rem;text-align:left;white-space:normal;word-break:break-word;overflow-wrap:break-word}.transactions-table th{background:#f1f5f9;color:#334155;font-weight:600;font-size:1rem;border-bottom:1px solid #e2e8f0;cursor:pointer}.transactions-table td{color:#22223b;font-size:0.98rem;border-bottom:1px solid #f1f5f9}.transactions-table tr:last-child td{border-bottom:none}.transactions-table tr:nth-child(even) td{background:#fff}.pagination{display:flex;gap:1.2rem;margin-bottom:0.5rem}.pagination button{background:#e5edfa;color:#22223b;border:none;border-radius:8px;font-weight:600;font-size:1.1rem;padding:0.7rem 1.5rem;transition:background 0.2s}.pagination button:disabled{background:#f1f5f9;color:#b0b7c3;cursor:not-allowed}.pagination button:hover:not(:disabled){background:#c7d7f7}.error{color:#e11d48;background:#fef2f2;border-radius:8px;padding:1rem;margin-top:2rem;font-size:1.05rem;border:1px solid #fecaca}@media (max-width: 900px){.transactions-container{max-width:98vw;padding:1.2rem 0.5rem 1rem 0.5rem}.top-bar h2{font-size:1.3rem}}@media (max-width: 700px){.transactions-container{max-width:98vw;min-width:0;padding:1rem 0.3rem 0.7rem 0.3rem}.transactions-table{font-size:0.95rem;display:block;overflow-x:auto}.transactions-table th,.transactions-table td{padding:0.4rem 0.3rem;font-size:0.95rem;white-space:normal;word-break:break-word;overflow-wrap:break-word}}@media (max-width: 600px){.transactions-container{padding:0.7rem 0.2rem 0.7rem 0.2rem;min-width:0}.top-bar{flex-direction:column;align-items:stretch;gap:0.7rem}.top-bar h2{font-size:1.1rem;text-align:left}.export-btn,.back-btn{width:100%;font-size:0.95rem;padding:0.7rem 0.7rem}}@media (max-width: 500px){.transactions-container{padding:0.7rem 0.1rem 0.7rem 0.1rem}.transactions-table th,.transactions-table td{font-size:0.92rem;padding:0.3rem 0.2rem}}";const m=class{constructor(e){t(this,e);this.back=r(this,"back");this.notificationChange=r(this,"notificationChange")}walletId;back;notificationChange;async handleExportCSV(){try{const t=await fetch(`${n}/transactions?walletId=${this.walletId}&skip=0&limit=10000`);if(!t.ok){throw new Error(`Failed to fetch transactions: ${t.statusText}`)}const e=await t.json();let a="wallet";try{const t=await fetch(`${n}/wallet/${this.walletId}`);if(!t.ok){throw new Error(`Failed to fetch wallet: ${t.statusText}`)}const e=await t.json();a=e.name||"wallet"}catch(t){console.warn("Failed to fetch wallet name, using default:",t)}const r=["Date","Amount","Description","Type","Balance"];const i=e.map((t=>[t.date?new Date(t.date).toLocaleString():t.transaction_time_stamp?new Date(t.transaction_time_stamp).toLocaleString():"",t.amount?.toFixed(4)??"",t.description||"",t.type?t.type.charAt(0).toUpperCase()+t.type.slice(1).toLowerCase():"",t.balance?.toFixed(4)??""]));let o=r.join(",")+"\n";o+=i.map((t=>t.map((t=>'"'+(t!=null?String(t).replace(/"/g,'""').replace(/\n/g," "):"").trim()+'"')).join(","))).join("\n");const s=new Date;const d=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")}`;const c=a.replace(/[^a-zA-Z0-9_-]/g,"");const l=`${c}_transactions_${d}.csv`;const b=new Blob([o],{type:"text/csv;charset=utf-8;"});const h=URL.createObjectURL(b);const f=document.createElement("a");f.href=h;f.download=l;f.click();URL.revokeObjectURL(h);this.notificationChange.emit({message:"Transactions exported successfully",type:"success"})}catch(t){console.error("Export failed:",t);this.notificationChange.emit({message:t instanceof Error?t.message:"Failed to export transactions",type:"error"})}}render(){return e("div",{key:"5bd2360b890076e33ab2f9a5713191171d1441af",class:"transactions-container"},e("div",{key:"62bbc4f2620d94f57d4bd44e0d4c6c2ba8dffebd",class:"top-bar"},e("button",{key:"99ac9c37883170ab9a6438b7b4c2ead069e14c42",class:"back-btn",onClick:()=>this.back.emit()},"← Back"),e("h2",{key:"c525d2c0e683d8e927b597e8ed1b47d61ebebd73"},"Transactions"),e("button",{key:"3252dcc97c2c6b8d0d7e548b81885bb187336d11",class:"export-btn",onClick:()=>this.handleExportCSV()},"Export CSV")),e("wallet-transactions-table",{key:"a2c0dafec2c6ddf7fc4f0894ca3bb7014efffb3b","wallet-id":this.walletId}))}};m.style=f;const p=":host{display:flex;flex-direction:column;align-items:center;min-height:100vh;background:#f7f9fb;font-family:'Inter', 'Segoe UI', Arial, sans-serif}.transactions-container{background:#fff;border-radius:18px;box-shadow:0 2px 16px rgba(0,0,0,0.07);padding:2rem 2rem 1.5rem 2rem;margin:1.5rem auto 0 auto;width:100%;max-width:900px;min-width:320px;box-sizing:border-box;display:flex;flex-direction:column;align-items:flex-start}.top-bar{display:flex;align-items:center;gap:2rem;margin-bottom:1.5rem;background:none;border-radius:0;box-shadow:none;padding:0}.top-bar .back-btn{background:#f7f9fb;color:#2563eb;border:1.5px solid #2563eb;font-weight:600;border-radius:8px;padding:0.45rem 1.1rem;font-size:1rem;transition:background 0.2s, color 0.2s;box-shadow:0 1px 4px rgba(0,0,0,0.03);margin-right:1.5rem}.top-bar .back-btn:hover{background:#2563eb;color:#fff}.top-bar h2{margin:0;font-size:2rem;font-weight:700;color:#22223b}.export-btn{background:#2563eb;color:#fff;border:none;border-radius:8px;font-weight:600;font-size:1.1rem;padding:0.7rem 2rem;margin-bottom:1.2rem;margin-top:0.5rem;transition:background 0.2s}.export-btn:hover{background:#1d4ed8}.table-container{width:100%;overflow-x:auto;margin-top:1.5rem;background:none}.transactions-table{width:100%;border-collapse:collapse;background:#f7f9fb;font-size:1rem;min-width:600px}.transactions-table thead,.transactions-table tbody{display:table;width:100%;table-layout:fixed}.transactions-table th,.transactions-table td{padding:0.9rem 1.1rem;text-align:left}.transactions-table th{background:#f1f5f9;font-weight:600;color:#22223b;font-size:1.05rem}.transactions-table tr{background:#fff;border-bottom:1px solid #e5e7eb}.transactions-table tr:last-child{border-bottom:none}.transactions-table tr:nth-child(even) td{background:#fff}.pagination{display:flex;gap:1.2rem;margin-bottom:0.5rem}.pagination button{background:#e5edfa;color:#22223b;border:none;border-radius:8px;font-weight:600;font-size:1.1rem;padding:0.7rem 1.5rem;transition:background 0.2s}.pagination button:disabled{background:#f1f5f9;color:#b0b7c3;cursor:not-allowed}.pagination button:hover:not(:disabled){background:#c7d7f7}.error{color:#e11d48;background:#fef2f2;border-radius:8px;padding:1rem;margin-top:2rem;font-size:1.05rem;border:1px solid #fecaca}@media (max-width: 900px){.transactions-table{font-size:0.95rem;min-width:480px}.transactions-table th,.transactions-table td{padding:0.7rem 0.7rem}}@media (max-width: 700px){.transactions-container{max-width:98vw;min-width:0;padding:1rem 0.3rem 0.7rem 0.3rem}.transactions-table{font-size:0.95rem;display:block;overflow-x:auto}.transactions-table th,.transactions-table td{padding:0.4rem 0.3rem;font-size:0.95rem;white-space:normal;word-break:break-word;overflow-wrap:break-word}}@media (max-width: 600px){.table-container{margin-top:0.7rem}.transactions-table{font-size:0.9rem;min-width:350px}.transactions-table th,.transactions-table td{padding:0.5rem 0.4rem}}@media (max-width: 500px){.transactions-container{padding:0.7rem 0.1rem 0.7rem 0.1rem}.transactions-table th,.transactions-table td{font-size:0.92rem;padding:0.3rem 0.2rem}}";const g=class{constructor(e){t(this,e)}walletId;transactions=[];total=0;skip=0;limit=5;loading=false;error="";sortBy="transaction_time_stamp";sortDir="desc";cachedData="";componentWillLoad(){this.fetchTransactions()}shouldFetchData(){const t=JSON.stringify({walletId:this.walletId,skip:this.skip,limit:this.limit,sortBy:this.sortBy,sortDir:this.sortDir});if(t!==this.cachedData){this.cachedData=t;return true}return false}async fetchTransactions(){if(!this.shouldFetchData())return;try{this.loading=true;const t=await fetch(`${n}/transactions?walletId=${this.walletId}&skip=${this.skip}&limit=${this.limit}&sortBy=${this.sortBy}&sortDir=${this.sortDir}`);if(!t.ok)throw new Error("Failed to fetch transactions");const e=await t.json();const a=await fetch(`${n}/transactions/count?walletId=${this.walletId}`);if(!a.ok)throw new Error("Failed to fetch transaction count");const r=await a.json();this.transactions=e;this.total=r.total;this.error=""}catch(t){this.error=t.message}finally{this.loading=false}}walletIdChanged(){this.fetchTransactions()}handleSort=t=>{const e=this.sortBy===t?this.sortDir==="asc"?"desc":"asc":"desc";this.sortBy=t;this.sortDir=e;this.fetchTransactions()};handlePaginate=t=>{this.skip=t;this.fetchTransactions()};arrow=t=>{if(this.sortBy!==t)return e("span",{style:{opacity:"0.3"}},"↑↓");return this.sortDir==="asc"?e("b",null,"↑"):e("b",null,"↓")};render(){const t=this.skip===0;const a=this.skip+this.limit>=this.total;return e("div",{key:"4ad92fca9a98220c84bb98aeb68429cf77aeb696",class:"table-container",style:{position:"relative"}},e("table",{key:"0728bd42d17128cf1b10f227fc7852c05b42455e",class:"transactions-table",style:{position:"relative"}},e("thead",{key:"08f9620435856d714a2ec0a6c89fa1c47b5614bf"},e("tr",{key:"628897c36e51e489c742979fbc0b0516a8d2f892"},e("th",{key:"2a693be8855ecccf8ea1ba6135534978baec38b5",onClick:()=>this.handleSort("transaction_time_stamp"),style:{cursor:"pointer"}},"Date ",this.arrow("transaction_time_stamp")),e("th",{key:"c6c316ad0dcdc6b63dfdd72c7d6d68e082b242c3",onClick:()=>this.handleSort("amount"),style:{cursor:"pointer"}},"Amount ",this.arrow("amount")),e("th",{key:"0a1b9fda9c09cd72cb552e41bd78032b45bc2d2a"},"Description"),e("th",{key:"bd47f5bfca4be52fbce8b71163891c5ae8e19735"},"Type"),e("th",{key:"ab384b8ed510b5ba252608d460ddc7c1e33cdac7"},"Balance"))),e("tbody",{key:"159fbddc79d0e2bf9f8057993b987098b0adddd5"},this.transactions.map((t=>e("tr",null,e("td",null,t.date?new Date(t.date).toLocaleString():""),e("td",null,typeof t.amount==="number"?t.amount.toFixed(4):""),e("td",null,t.description||""),e("td",null,t.type?t.type.charAt(0).toUpperCase()+t.type.slice(1).toLowerCase():""),e("td",null,typeof t.balance==="number"?t.balance.toFixed(4):"")))),this.transactions.length===0&&!this.loading&&e("tr",{key:"b3dac9576f9034ca276e95b7a1176fb2c1f7e9a2"},e("td",{key:"b692b74676c67e6be6a7f7bc49a724d2f9580c48",colSpan:5,style:{textAlign:"center",padding:"2rem"}},"No transactions found")))),e("div",{key:"123038a76042a5a8b5c780dcf6afc2db764f26dc",class:"pagination"},e("button",{key:"55da99df5fc766d633387357e6f0cefbafec0d48",disabled:t||this.loading,onClick:()=>this.handlePaginate(Math.max(0,this.skip-this.limit))},"Prev"),e("button",{key:"bcc9b09e54e79bd59d1901ae6ba080aee1a8e8a8",disabled:a||this.loading,onClick:()=>this.handlePaginate(this.skip+this.limit)},"Next")),this.error&&e("div",{key:"371d610559fe03874d0de7599be7b09ac729f690",class:"error"},this.error))}static get watchers(){return{walletId:["walletIdChanged"]}}};g.style=p;export{o as notification_toast,d as wallet_app_root,l as wallet_dashboard,h as wallet_setup,m as wallet_transactions,g as wallet_transactions_table};
//# sourceMappingURL=p-1153b254.entry.js.map